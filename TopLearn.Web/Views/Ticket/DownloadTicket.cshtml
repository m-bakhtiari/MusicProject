@model List<TopLearn.DataLayer.Entities.Course.ConcertTicket>

<section data-scroll-section>

    <div style="text-align:center ;margin-top:80px;" >
        <p>برای دانلود بلیط دکمه زیر را کلیک نمایید</p>
        <button type="button" onclick="getTicket()" class="btn btn-primary" 
        style="background-color:blue;color:white;">دانلود بلیط</button>
    </div>

    <div id="content">
        @foreach (var item in Model)
        {

            @foreach (var seat in item.ConcertTicketSeats.Where(x => x.IsPay == true))
            {

                <div class="main-content no-break">
                    <div class="ticket">
                        <div class="ticket__main">
                            <div class="header">کنسرت بزرگ هاوانا</div>
                            <div class="info passenger">
                                <div style="font-size: 11px;color: black">: نام طرفدار</div>
                                <div class="info__detail">@item.FirstName&nbsp;@item.LastName</div>
                            </div>
                            <div class="info platform">
                                <span>ردیف</span>
                                <br>
                                <span style="font-size: 30px;">@seat.SeatNumber.Split("-")[0]</span>
                                <br>
                                <span>صندلی</span>
                                <br>
                                <span style="font-size: 30px;">@seat.SeatNumber.Split("-")[1]</span>
                            </div>
                            <div class="info departure">
                                <div class="info__item">:مکان</div>
                                <div class="info__detail">سالن خلیج فارس - نیاوران</div>
                            </div>
                            <div class="info arrival">
                                <div class="info__item">:سرپرست </div>
                                <div class="info__detail">وحید نجفی زاده</div>
                            </div>
                            <div class="info date">
                                <div class="info__item">تاریخ</div>
                                <div class="info__detail">پنج شنبه 27 آذرماه 1404</div>
                            </div>
                            <div class="info time">
                                <div class="info__item">زمان</div>
                                <div class="info__detail">17:00</div>
                            </div>
                            <div class="info carriage">
                                <div class="info__item">ردیف</div>
                                <div class="info__detail">@seat.SeatNumber.Split("-")[0]</div>
                            </div>
                            <div class="info seat">
                                <div class="info__item">صندلی</div>
                                <div class="info__detail">@seat.SeatNumber.Split("-")[1]</div>
                            </div>
                            <div class="fineprint">
                                <p>
                                    آدرس : تهران, خیابان پاسداران، بعد از سه راه اقدسیه، روبروی پارک نیاوران، خیابان فرهنگسرا,
                                    فرهنگسرای نیاوران - سالن خلیج فارس
                                </p>
                                <p>این بلیط غیر قابل فروش می باشد. لطفا نیم ساعت زودتر در محل کنسرت حضور داشته باشید</p>
                            </div>
                            <div class="snack">
                                <img src="SiteTemplate/img/QRCODE.jpg" alt="qrcode" />
                            </div>
                            <div class="barcode">
                                <div class="barcode__scan"></div>
                                <div class="barcode__id">@item.Mobile@seat.ConcertTicketSeatId</div>
                            </div>
                        </div>

                    </div>
                </div>

            }

        }
        <aside class="context">
            <div class="explanation">
                <b>www.VahidNajafizadeh.com</b>
            </div>
        </aside>
    </div>
    <hr>
    <div style="text-align: center;">
        <p style="color: white; margin: 3px; font-weight: bolder; border-bottom: 1px solid whitesmoke; text-decoration: none">
            لطفا در زمان ورود به سالن بلیط را همراه داشته باشید
        </p>

    </div>

</section>


@section Styles
{

    <style>

        aside.context a {
            text-decoration: none;
            color: #333;
            padding: 3px 0;
            border-bottom: 1px dashed;
        }

            aside.context a:hover {
                border-bottom: 1px solid;
            }

        aside.context .explanation {
            max-width: 700px;
            margin: 4em auto 0;
            color: white;
        }


        .main-content {
            margin: 1rem auto 0;
            width: 650px;
            text-transform: uppercase;
            color: #000000;
            direction: ltr !important;
        }

        .ticket {
            width: 600px;
            display: grid;
            grid-template-columns: auto;
            background: #f3f1c9;
            border-radius: 10px;
            border: 2px solid #222;
        }

        .ticket__main {
            display: grid;
            grid-template-columns: repeat(6, 1fr) 120px;
            grid-template-rows: repeat(4, min-content) auto;
            padding: 10px;
        }

        .header {
            grid-area: title;
            grid-column: span 7;
            grid-row: 1;
            padding: 5px 0 5px 20px;
            background: #111;
            color: #f3f1c9;
            text-align: center;
        }

        .info {
            border: 2px solid;
            border-width: 0 3px 3px 0;
            padding: 5px;
        }

        .info__item {
            font-size: 12px;
            text-align: right !important;
        }

        .info__detail {
            margin: 4px 0;
            text-align: center !important;
        }

        .passenger {
            grid-column: 1/span 6;
        }

        .platform {
            grid-column: 7/span 1;
            grid-row: 2/span 3;
            background: #c02a28;
            color: #fff;
            border-color: #000;
            text-align: center;
        }

            .platform span {
                display: block;
            }

            .platform .number {
                display: flex;
                margin-top: 12px;
                position: relative;
            }

                .platform .number div:nth-child(1) {
                    position: absolute;
                    left: 16px;
                }


        .departure,
        .arrival {
            grid-column-start: span 3;
        }

        .passenger,
        .departure,
        .date {
            border-left: 3px solid;
        }

        .date,
        .time {
            grid-column-start: span 2;
        }

        .fineprint {
            grid-column-start: span 5;
            font-size: 14px;
            line-height: 1;
            margin-top: 10px;
            padding-right: 5px;
            text-align: right !important;
        }

            .fineprint p:nth-child(1) {
                line-height: 1.4;
            }

            .fineprint p:nth-child(2) {
                margin: 4px 4px 0 0;
                padding-top: 4px;
                border-top: 1.5px dotted;
                text-align: right !important;
                font-size: 10px;
            }

        .snack {
            grid-column: 6/span 1;
            width: 65px;
            margin: 10px 10px 0 0;
            position: relative;
            background: transparent;
            padding: 6px 0 2px;
            text-align: center;
            border-radius: 5px;
        }

            .snack img {
                width: 100%;
            }

        .snack__name {
            color: #f3f1c9;
            font-size: 12px;
        }

        .barcode {
            grid-column-start: span 1;
            display: grid;
            margin: 10px 0 0;
            grid-template-rows: 1fr min-content;
        }

        .barcode__scan {
            background: linear-gradient(to right, #333 2%, #333 4%, transparent 4%, transparent 5%, #333 5%, #333 6%, transparent 6%, #333 6%, #333 8%, transparent 8%, transparent 9%, #333 9%, #333 10.5%, transparent 10.5%, transparent 11%, #333 11%, #333 12%, transparent 12%, transparent 13.5%, #333 13.5%, #333 15%, #333 17%, transparent 17%, transparent 19%, #333 19%, #333 20%, transparent 20%, transparent 21%, #333 21%, #333 22%, transparent 22%, transparent 23.5%, #333 23.5%, #333 25%, transparent 25%, transparent 26.5%, #333 26.5%, #333 27.5%, transparent 27.5%, transparent 28.5%, #333 28.5%, #333 30%, transparent 30%, transparent 32%, #333 32%, #333 34%, #333 36%, transparent 36%, transparent 37.5%, #333 37.5%, #333 40%, transparent 40%, transparent 41.5%, #333 41.5%, #333 43%, transparent 43%, transparent 46%, #333 46%, #333 48%, transparent 48%, transparent 49%, #333 49%, transparent 49%, transparent 50%, #333 50%, #333 51%, transparent 51%, transparent 53%, #333 53%, #333 54.5%, transparent 54.5%, transparent 56%, #333 56%, #333 58%, transparent 58%, transparent 59%, #333 59%, #333 60%, #333 62.5%, transparent 62.5%, transparent 64%, #333 64%, #333 64%, #333 67%, transparent 67%, transparent 69%, #333 69%, #333 70%, transparent 70%, transparent 71%, #333 71%, #333 72%, transparent 72%, transparent 73.5%, #333 73.5%, #333 76%, transparent 76%, transparent 79%, #333 79%, #333 80%, transparent 80%, transparent 82%, #333 82%, #333 82.5%, transparent 82.5%, transparent 84%, #333 84%, #333 87%, transparent 87%, transparent 89%, #333 89%, #333 91%, transparent 91%, transparent 92%, #333 92%, #333 95%, transparent 95%);
        }

        .barcode__id {
            padding: 2px 0 0;
            color: #c02a28;
            font: 700 16px/1 "Jura";
        }

        .no-break {
            page-break-inside: avoid;
            break-inside: avoid;
        }
         #content{
            overflow-x: auto;
            overflow-y: hidden;
            width: 100%;
         }

    </style>
}

@section Scripts
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script>
        function getTicket() {

            // var element = document.getElementById('content');
            // html2pdf().from(element).save('document.pdf');
                    var element = document.getElementById('content'); // یا هر بخش اصلی

        var opt = {
            margin:       0.5,
            filename:     'ticket.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2 },
            jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },
            pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] }
        };

        html2pdf().set(opt).from(element).save();

        }

    </script>

}
